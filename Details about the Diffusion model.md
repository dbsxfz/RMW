We outline the four core requirements for harmless watermark samples in Section 4.1.1: Clarity, Challenge, Stealthiness, and Resilience. The purpose of employing a diffusion model is to ensure the clarity and stealthiness of UAEs while maintaining sufficient challenge and resilience. A class-conditioned diffusion model trained on the same dataset as the protected model can utilize the entire pipeline proposed in our paper to generate high-quality UAEs from Gaussian noise. However, a pretrained diffusion model can also be used to modify validation samples into UAEs, with a slight sacrifice in sample quality and transferability across models. In our future work, we will explore large-scale pretrained diffusion models such as Stable Diffusion to generate UAEs for nearly any dataset from random noise, as discussed in the supplementary material.

In our experiments detailed in the main text, we trained two EDMs for CIFAR-10/100 (detailed configurations are in the 'UAE generator' folder), and utilized the Imagenet pretrained guided diffusion model ([https://github.com/openai/guided-diffusion](https://github.com/openai/guided-diffusion)) for Imagenette.